<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Subscribe to UnlockIT - AI and IT Training for Beginners"
    />
    <title>Subscribe - UnlockIT</title>

    <link rel="stylesheet" href="/src/assets/base.css">
    <link rel="stylesheet" href="/src/assets/main.css">

    <script>
      ;(function (w, d, e, u, f, l, n) {
        ;(w[f] =
          w[f] ||
          function () {
            ;(w[f].q = w[f].q || []).push(arguments)
          }),
          (l = d.createElement(e)),
          (l.async = 1),
          (l.src = u),
          (n = d.getElementsByTagName(e)[0]),
          n.parentNode.insertBefore(l, n)
      })(window, document, 'script', 'https://assets.mailerlite.com/js/universal.js', 'ml')
      ml('account', '1515575')
    </script>
    <!-- End MailerLite Universal -->
  </head>
  <body class="min-h-screen bg-gradient-to-br from-primary-600 to-primary-800 flex items-center justify-center p-4">
    <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-lg w-full text-center">
      <div class="text-3xl font-bold text-primary-600 mb-4" id="logo">UnlockIT</div>
      <h1 class="text-2xl font-semibold text-gray-900 mb-4" id="title"></h1>
      
      <div class="my-8 min-h-[300px]">
        <div class="ml-embedded" data-form="SwG5CC"></div>
      </div>
      
      <a href="/enterit" class="inline-block bg-gray-100 text-gray-700 px-6 py-3 rounded-lg font-medium hover:bg-gray-200 transition-colors mt-8" id="backButton">‚Üê EnterIT</a>
    </div>
  </body>

  <!-- i18n Support -->
  <script>
    let i18n = {};
    
    function detectLanguage() {
      const urlParams = new URLSearchParams(window.location.search);
      const lang = urlParams.get('lang');
      
      if (lang && (lang === 'en' || lang === 'pl')) {
        return lang;
      }
      
      const browserLang = navigator.language || navigator.userLanguage;
      
      if (browserLang.startsWith('pl')) {
        return 'pl';
      }
      
      return 'en';
    }
    
    async function loadLocale(lang) {
      try {
        const paths = [
          `/src/locales/${lang}.json`,
          `/locales/${lang}.json`,
          `./locales/${lang}.json`
        ];
        
        let localeData = null;
        for (const path of paths) {
          try {
            const response = await fetch(path);
            if (response.ok) {
              localeData = await response.json();
              break;
            }
          } catch (e) {
            console.log('Failed to load from:', path, e);
          }
        }
        
        if (localeData) {
          i18n[lang] = localeData;
          return localeData;
        } else {
          throw new Error('Could not load locale from any path');
        }
      } catch (error) {
        console.error(`Failed to load ${lang} locale:`, error);
        return null;
      }
    }
    
    function applyLanguage(lang) {
      const texts = i18n[lang];
      
      if (texts && texts.mailer) {
        const logo = document.getElementById('logo');
        const title = document.getElementById('title');
        const backButton = document.getElementById('backButton');
        
        if (logo && title && backButton) {
          document.title = texts.mailer.pageTitle;
          logo.textContent = texts.mailer.logo;
          title.textContent = texts.mailer.title;
          backButton.textContent = texts.mailer.backButton;
          document.documentElement.lang = lang;
        } else {
          console.error('Some DOM elements not found:', { logo, title, backButton });
        }
      } else {
        console.error('Mailer texts not found in locale:', texts);
      }
    }
    
    async function initI18n() {
      const lang = detectLanguage();
      
      const localeData = await loadLocale(lang);
      if (localeData) {
        applyLanguage(lang);
      } else {
        console.error('Failed to initialize i18n');
      }
    }
    
    initI18n();
  </script>
</html>
